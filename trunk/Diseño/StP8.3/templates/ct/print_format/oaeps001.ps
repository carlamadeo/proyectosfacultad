% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Copyright Aonix Corporation 2001
% Note: Do not change this file! This file is internaly used by oae templates 
%	to generate Postscript output. 
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

PageDict getPageUserCaps /UH exch def /UW exch def
/Annotattion Annotattion AFont UW WrapMultilineLabel store

% CalculatePage breaks:
/curentHeight	0 def
/curentLineIdx  0 def
/curentPageIdx	0 def
/pagebreaks Annotattion length array def % the maximum pages.
Annotattion {
	% label font GetLabelWidthAndHeight Wx Wy
	AFont GetLabelWidthAndHeight curentHeight add /curentHeight exch store pop
	curentHeight UH gt {
		pagebreaks curentPageIdx curentLineIdx put
		/curentPageIdx curentPageIdx 1 add store
	} if
	/curentLineIdx curentLineIdx 1 add store

	curentLineIdx Annotattion length eq {
		pagebreaks curentPageIdx curentLineIdx 1 sub put
	} if
} forall
/pagebreaks pagebreaks 0 curentPageIdx 1 add getinterval store

% Draw Pages:
/startPageLineIdx	0 def
/endPageLineIdx		0 def
0 1 pagebreaks length 1 sub {
	/curentPageIdx exch store
	/endPageLineIdx pagebreaks curentPageIdx get store

	PageDict curentPageIdx 1 add pagebreaks length drawPageFrame pop pop
	Fg GteColorSet
	
	% label font linespace Xo Yo Ax Ay  drawMultilineLabel
	Annotattion startPageLineIdx endPageLineIdx startPageLineIdx sub 1 add getinterval
	AFont
	Ls
	0 UH
	1 1 
		drawMultilineLabel
	showpage
} for
