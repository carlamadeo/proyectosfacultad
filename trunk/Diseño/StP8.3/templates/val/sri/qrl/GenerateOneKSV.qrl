external string use_case_name;

#include "qrl/tsdl_extract.inc"
#include "qrl/basic_textract_dt.inc"
#include "qrl/include/error.inc"

#include "val/qrl/include/TConfig.inc"
#include "val/qrl/include/TUseCase.inc"
#include "val/qrl/include/CreateDir.inc"

  list ScenarioList;
  list testcaselist;

  string scriptsdir =  current_projdir() + current_system() + "/testscpt_files/";

  string OUTPUTPATH = scriptsdir + "sri/";

   string OUTPUTDIR;

  string INPUTPATH = current_projdir() + current_system() + "/test_files/";
  string INPUTDIR;
  string FILETEXT;
  const string SEPARATOR = "###";
  const string SEPARATOR2 = "@@@";

void 
main ()
{
  message ("");
  message ("");
  message ("Creating Key Save Files");
  message ("");
  message ("");



  string test_unit_id;

  string filetext;

  string path;
  string inputfile;


  test_unit_id = Get_T_test_unit_id(use_case_name, "");

  ScenarioList = GetScenarioList(use_case_name);


  INPUTDIR = INPUTPATH + test_unit_id;
  OUTPUTDIR = OUTPUTPATH + test_unit_id;
  PrintScenarios(test_unit_id);

}

void
PrintScenarios(string test_unit_id)
{
  int i,count;
  node scenario;
  string fname;

  count = list_count(ScenarioList);

  for (i=0;i<count;i++)
    {
      scenario = list_get(ScenarioList, i);

      message ("");
      message ("");
      message ("Generating Key Save Files for   " + scenario.name);
      message ("");
      message ("");

      T_case_desc_dir = OUTPUTDIR + "/" + scenario.name;
      T_case_desc_file = T_case_desc_dir + "/" + scenario.name + ".cdf";


      if (!CheckForSDF(T_case_desc_dir, scenario.name + ".cdf"))
        {
           message ("");
           message ("       " + scenario.name + ".cdf  does not exist.");
           message ("");
           message ("");
           continue;
        }

      if (CheckForSDF(INPUTDIR, "TDDB"))
         tdriverPrepare (test_unit_id, T_case_desc_file, T_case_desc_dir);
      else
        {
           message ("");
           message ("TDDB file for " + test_unit_id + " does not exist.");
           message ("");
           message ("");
        }
    }
}
