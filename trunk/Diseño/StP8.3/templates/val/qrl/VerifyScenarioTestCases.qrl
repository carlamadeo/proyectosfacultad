external string UseCases;

#include "val/qrl/include/TConfig.inc"
#include "val/qrl/include/TUseCase.inc"
#include "val/qrl/include/CreateDir.inc"

  string OUTPUTPATH = current_projdir() + current_system() + "/test_files/";
  string OUTPUTDIR;

void 
main ()
{
  list UseCaseList, ScenarioList;
  int count1, i;
  int count2, j;
  string use_case_name, test_unit_id, scenario_name;
  node scenario;
  int scenario_id;


  UseCaseList = string_to_list (UseCases, " ");

  count1 = list_count (UseCaseList);

  for (i=0;i<count1;i=i+1)
    {

      use_case_name = list_get(UseCaseList,i);

      if (!CheckExistance (use_case_name) )
        {
          message ("Use Case: " + use_case_name + " is not in the selected model");
          continue;
        }


      ScenarioList = GetScenarioList(use_case_name);
      count2 = list_count (ScenarioList);
      for (j=0;j<count2;j=j+1)
        {
          scenario = list_get(ScenarioList,j);
          scenario_name = scenario.name;
          scenario_id = scenario.id;
          message ("##" + scenario_name + "##" );
          test_unit_id = Get_T_test_unit_id(use_case_name, scenario_name);

          OUTPUTDIR = OUTPUTPATH + test_unit_id;
          message (OUTPUTDIR); 

          if (CheckForSDF(OUTPUTDIR, "sdf" ))
            tdriverVerify (test_unit_id);
          else
            message ("SDF file for " + test_unit_id + " does not exist.");
        }
    }

}

