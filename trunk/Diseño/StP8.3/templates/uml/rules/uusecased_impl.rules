//      StP/UML
//      Confidential property of Aonix
//      Copyright (c) 1997
//      All rights reserved


NodeSymbol 10 Actor	// shared definition
{}

Include "rules/actor_sym.rules.common"


NodeSymbol 20 Note // shared definition - see also vertex
{}

// ECR947, ECR 4494
// Added CommentAnchor
CntxSymbol CommentAnchor
{
    { ParentLink AllLinkSymbols }
}
// End ECR947, ECR 4494

NodeSymbol 30 Package // Package symbol is shared
{}
NodeSymbol 31 PackageName
{
    //{ Cardinality { Min 1 } { Max 1 } { InLinks PackageComponentLink } }
    { Cardinality { Min 1 } { Max 1 } { InLinks Contains } }
}
Include "rules/package_sym.rules.common"


NodeSymbol 40 System
{
    { PrintName "This System" }
    { Shape
        { Predefined Rectangle }
        { ToolbarImage "this_system" }
    }
    { DefaultSize 1.5 1.5 }
    { AutoScaleLarger True }
    //{ UniformScale True }
    { LabelAnchor North }
    { HAdjust Center }
    { VAdjust Top }
    { CanAdjustLabel False }
    { DisplayMark
	{ Name ThisSystem }
	{ StringMark "This System" }
	{ Anchor UpperRight }
	{ HAdjust Right }
	{ VAdjust Bottom }
	{ Help "Constant string for this system" }
    }
    { NodeMapping
	{ AppType UmlSystem }
	{ NameIsRequired True }
	{ MappingName ClassMapping }
    }
}

NodeSymbol 50 UseCase
{
    { ReadOnly False }
    { PrintName "Use Case" }
    { Shape
        { Predefined Ellipse }
        { ToolbarImage "use_case" }
    }
    { DefaultSize 2.2 0.7 }
    { NodeMapping
	{ AppType UmlUseCase }
	{ NameIsRequired True }
	{ MappingName ClassMapping }
	{ NameFunc uml_gde_node_name_func }
    }
    { DisplayMark
	{ Name UseCaseScenariosExist }
	{ CondFunc "UseCaseHasScenarioOrActivity(\"${node.name}\");" } // ECR 7735
	{ LabelMark	Box }
	{ XPixelOffset 4 }
	{ YPixelOffset 4 }
	// { StringMark "*" }
	// { Anchor LabelLowerCenter }
	// { HAdjust Center }
	// { VAdjust Top }
	// { YPixelOffset 5 }
	{ Help "Use Case has Scenarios associated with it" }
    }
    { CanAdjustLabel True }
    { AutoScaleSmaller False }
    { AutoScaleLarger True }
    { CanApplyScaleCmd True }
    { RenameFunc uml_usecase_rename }
    // ECR 2850
    { LabelAnchor North }
    { DisplayMark
        { Name UseCaseExtensionPoint }
        { ItemCond (UmlUseCaseExtensionPoint) }
        { StringMarkFunc "show_uc_extension_point(${node.id}, 0${nodesym.psymid});" }
        { Anchor UpperCenter }
        { HAdjust Center }
        { VAdjust Top }
        { XPixelOffset 0 }
        { YPixelOffset 10 }
    }
    // ECR 2850
    // Begin Add ECR 6389
    { DisplayMark
        { Name UDescription }
        { CondFunc "symbol_has_description(0${node.id});" }
        { Anchor LowerRight }
        { VAdjust Bottom }
        { HAdjust Center }
        { YPixelOffset 19 }
        { BitmapMark0 "descln0" }
        { BitmapMark1 "descln1" }
        { BitmapMark2 "descln2" }
        { Help "UseCase has description." }
    }
    // End Add ECR 6389
}

TypeSet AllLinkSymbols
{
    Communicates
    Extends
    Uses
    Inherits
    Contains
    NoteLink // ECR 4496
    Generalization // ECR 4494
}

// SPR 4052 - Model Management
// used for Model Management to have one common display mark
TypeSet AllLockableNodeTypes
{
    Actor
    Package
    System
    UseCase
}

NodeSymbol 60 Vertex // shared symbol
{
    { ReplaceSet (None) }
    { Cardinality { Min 1 } { Max 1 } { InLinks AllLinkSymbols } }
    { Cardinality { Min 1 } { Max 1 } { OutLinks AllLinkSymbols } }
}

Include "rules/note_vertex_syms.rules.common"

TypeSet AllNoteableNodeTypes
{
    Actor
    Package
    PackageName
    System
    UseCase
// ECR947, ECR 4494
    CommentAnchor
// End ECR947, ECR 4494
}

LinkSymbol 120 Communicates
{
    { PrintName "Communicates" }
    { Connects 
	{ From Actor }
	{ To UseCase }
	{ IsDefault True }
    }
    { IsDirectional False }
    { CanHaveLabel True }
    //{ ToArrow True }	
    //{ FromArrow True }	
    { Uncentered True }
    { LinkMapping
	{ MappingName InteractionMapping }
	{ AppType UmlUseCaseInteraction }
	{ FromNode  { Symbol FromNode } }
	{ ToNode  { Symbol ToNode } }
	{ FromNode 
	    { Symbol FromNode }
	    { MappingName ObjectMapping }
	}
	{ ToNode 
	    { Symbol ToNode }
	    { MappingName ClassMapping }
	}
    }
}


LinkSymbol 130 Extends
{
    { PrintName "Extend" }
    { Connects
	{ From UseCase } { To UseCase }
      { CanBeReflexive False }  // ECR 3163
    }
    { CanHaveLabel False } //True
    { ToSmallCircle False } //True
    { ToLargeArrow True }	
    // Add ECR 4114
    { ToOpenArrow True }
    { Dashed True }	
    // End ECR 4114
    { ToFilledArrow False }	
    { Uncentered True }
    { LinkMapping
	{ MappingName ExtendsMapping }
	{ AppType UmlUseCaseExtends }
	{ FromNode 
	    { Symbol FromNode }
	    { MappingName ClassMapping }
	}
	{ ToNode 
	    { Symbol ToNode }
	    { MappingName ClassMapping }
	}
    }
    { DisplayMark
	{ Name UseCaseExtends }
	{ ItemCond (UmlStereotype) }
	{ CallUncond True }
	//{ StringMark "<<extends>>" }
    // ECR 4114
	{ StringMarkFunc "uml_label_mark_func_get_default(gde_dmark_matched_items,\"extend\");" }
	{ Anchor LabelUpperCenter } //LabelLowerCenter
	{ HAdjust Center }
	{ VAdjust Top }
	{ XPixelOffset 0 }
	{ YPixelOffset 5 }
    // ECR 4114
	{ Help "Constant Use Case <<extend>> String" }
    }
}

LinkSymbol 140 Uses
{
    // ECR 4114
    { PrintName "Include" }
    { Connects
	{ From UseCase } { To UseCase }
	{ IsDefault True }
      { CanBeReflexive False }  // ECR 3163
    }
    { CanHaveLabel False } // True
    { ToLargeArrow True }	
    // Change ECR 4114
    { ToOpenArrow True }
    { Dashed True }	
    // End ECR 4114
    { Uncentered True }
    { LinkMapping
	{ MappingName UsesMapping }
	{ AppType UmlUseCaseUses }
	{ FromNode 
	    { Symbol FromNode }
	    { MappingName ClassMapping }
	}
	{ ToNode 
	    { Symbol ToNode }
	    { MappingName ClassMapping }
	}
    }
    { DisplayMark
	{ Name UseCaseUses }
	{ ItemCond (UmlStereotype) }
	{ CallUncond True }
	//{ StringMark "<<uses>>" }
	// ECR 4114
	{ StringMarkFunc "uml_label_mark_func_get_default(gde_dmark_matched_items,\"include\");" }
	{ Anchor LabelUpperCenter } //LabelLowerCenter
	{ HAdjust Center }
	{ VAdjust Top }
	{ XPixelOffset 0 }
	{ YPixelOffset 5 }
    // ECR 4114
	{ Help "Constant Use Case <<include>> String" }
    }
}

// Begin Add ECR 4114
LinkSymbol 180 Generalization
{
    { PrintName "Generalization" }
    { CanHaveLabel False }
    { Uncentered True }
    { ToLargeArrow True }	// the arrow points to the superclass
    { ToFilledArrow False }
    { Connects 
        { From UseCase } { To UseCase }
        { CanBeReflexive False }  // ECR 3163
    }
    { LinkMapping
    	{ AppType UmlGeneralization }
    	{ MappingName InheritsMapping }
    	{ FromNode 
    	    { Symbol FromNode }
    	    { MappingName ClassMapping }
    	}
    	{ ToNode 
    	    { Symbol ToNode }
    	    { MappingName ClassMapping }
    	}
    }
}
// End Add ECR 4114

LinkSymbol 150 Inherits
{
    { Connects { From Actor } { To Actor } }
    { CanHaveLabel False } // True
    { PrintName "Use Case Actor Inheritance" }
    { Uncentered True }
    //{ Dashed True }
    { ToLargeArrow True }
    { LinkMapping
	{ AppType UmlGeneralization }
	{ MappingName InheritsMapping }
	{ FromNode 
	    { Symbol FromNode }
	    { MappingName ObjectMapping }
	}
	{ ToNode 
	    { Symbol ToNode }
	    { MappingName ObjectMapping }
	}
    }
    // ECR 4114
    // no <<inherits>> stereotype in UML 1.3 anymore
//    { DisplayMark
//	{ Name UseCaseInherits }
//	{ ItemCond (UmlStereotype) }
//	{ CallUncond True }
	//{ StringMark "<<inherits>>" }
//	{ StringMarkFunc "uml_label_mark_func_get_default(gde_dmark_matched_items,\"inherits\");" }
//	{ Anchor LabelUpperCenter } //LabelLowerCenter
//	{ HAdjust Center }
//	{ VAdjust Top }
//	{ XPixelOffset 0 }
//	{ YPixelOffset 5 }
//	{ Help "Constant Use Case <<inherits>> String" }
//    }

}


TypeSet	AutoScaleNodes
{
    UseCase
}

NodeSymbol AutoScaleNodes
{
    { AutoScaleSmaller False }
    { AutoScaleLarger True }
    { CanApplyScaleCmd True }
}



// Containment

LinkSymbol 160 Contains
{
    //{ PrintName "Contains" }
    { Connects { From System } { To Package } }
    { Connects { From System } { To UseCase } }
    { Connects { From Package } { To Package } }
    { Connects { From Package } { To UseCase } }
    { LinkMapping
	{ MappingName ComponentMapping }
	{ AppType UmlContains }
	{ FromNode
	    { Symbol FromNode }
	    { MappingName ClassMapping } }
	{ ToNode
	    { Symbol ToNode }
	    { MappingName ClassMapping } } }
    { Uncentered True }
    { CanBeVisible False }
    { CanBeSelected False }
    { CanBeInclude True }
}

// SPR 4052 Model management, different location of stereotype for packages
TypeSet StereotypeableOnPackageNodeSet
{
    Package
    PackageName
}

TypeSet StereotypeableOnSymbolNodeSet
{
    // nodes
    Actor
    //System
    UseCase
}

TypeSet StereotypeableLinkSet 
{
    // links
    Communicates
//     Extends
//     Uses
//     Inherits
}

Include "rules/stereotype_dm.rules.common"


DisplayMarkGroups
{
    { Group
        { Name UseCaseInfo }
        { DisplayMarks (UseCaseUses UseCaseExtends UseCaseInherits) }
    }
    { Group
        { Name Stereotype}
        { DisplayMarks (Stereotype StereotypeLink) }
    }
    { ContinuousDisplayMarks
        (
            Stereotypes
            UseCaseInfo
        )
    }
	// Description for ECR 6389
	{ Group
	    { Name Description }
	    { DisplayMarks (ADescription UDescription PDescription) }
	}
	{ OnDemandDisplayMarks (Description) }
}

Command CheckSemantics
{
  { PrintName "Check Semantics" }
  { StartMessage "Check Diagram Semantics" }
  // ECR 7464
  // { Builtin "EditorQrlEval uml_diag_check_semantics(\"uusecased_check_semantics\");" }
  { Builtin "EditorQrlEvalNoSave uml_diag_check_semantics(\"uusecased_check_semantics\");" }
}


SymbolList
{
    { ShowStraightArc True }
    { ShowSpline True }
    { OrthogonalArcsAreAllowed True }
    { OrthogonalArcsAreDefault False }
    { Symbols
	(
	    Note
            SEPARATOR
	    System
            SEPARATOR
	    Package
	    UseCase
	    Actor
	)
    }
}



///////////////////////////////////////////////////////

Include "rules/uusecased.gui" // menus and navigations
Include "rules/uusecased.prop" 
Include "rules/objectada.prop"

///////////////////////////////////////////////////////

// Begin Add ECR3785
// TypeSet for all kind of uml node symbols
TypeSet NavigationNodeTypes
{
    Actor
    Package
    System
    UseCase
}

// Included navigation targets for all kind of uml node symbols
Include "uml/rules/uml_navigation.rules"
// End Add ECR3785

IncludeIfExists "user/uml/rules/user_uusecased.rules"


